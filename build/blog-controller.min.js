/*! chewieez.github.io 2017-11-20 */

function searchAllBlogs(e){blogPostsArray.forEach(t=>{let l=t.title.toLowerCase(),n=t.content.toLowerCase();l.includes(e)||n.includes(e)?blogSearchResults.push(t):console.log("can't find one")})}function loadFullPage(){function e(e){blogViewEl.innerHTML="";const t=parseInt(Array.from(e.target.classList).find(e=>{if(e.startsWith("page-"))return e}).split("-")[1]);t-1==0?a.style.visibility="hidden":(a.style.visibility="visible",a.className=`page-${t-1}`),t+1>n?r.style.visibility="hidden":(r.style.visibility="visible",r.className=`page-${t+1}`);const s=blogSearchResults.slice((t-1)*l,t*l);0===s.length?blogViewEl.innerHTML="\n                <p>No blog entries match your search parameters. </p>\n                ":s.forEach(e=>{let t=moment(e.published).format("dddd, MMMM Do YYYY");blogViewEl.innerHTML+=`\n                <article  id="blogPost-${e.id}">\n                        <h4 class="blog-title">${e.title}</h4>\n                        <p class="blog-subheading"><span class="special-text">by:</span> ${e.author}    <span class="special-text">published on:</span> ${t}</p>\n                        \n                        `,e.content.length>470?blogViewEl.innerHTML+=`\n                    <div id="blogContent-${e.id}" class="abridged">\n                        <p class="blog-content">${e.content}</p>\n                    </div>\n                    <button id="expandContent-${e.id}" class="expandContentBtn">Click to read more</button>\n                    `:blogViewEl.innerHTML+=`\n                    <div id="blogContent-${e.id}">\n                        <p class="blog-content">${e.content}</p>\n                    </div>\n                    `,blogViewEl.innerHTML+=`\n                <p class="blog-tags">tags: ${e.tags}</p>\n                <hr>\n                </article>\n                `})}let t=blogSearchResults.length;const l=5;let n=Math.ceil(t/l);const s=document.getElementById("blogPaginator");let o="<ul>";o+="<li><a id='previous' href='#'>&lt;</a></li>";for(var i=0;i<n;i++)o+=` <li><a class="blogPage page-${i+1}" href="#">${i+1}</a></li>`;o+="<li><a id='next' class='page-2' href='#'>&gt;</a></li>",o+="</ul>",s.innerHTML=o;const a=document.getElementById("previous"),r=document.getElementById("next"),g=document.getElementsByClassName("blogPage");for(let t=0;t<g.length;t++)g[t].addEventListener("click",e);e({target:{classList:["page-1"]}}),a.addEventListener("click",e),r.addEventListener("click",e),blogViewEl.addEventListener("click",expandContent)}function expandContent(e){let t=e.target.id,l=e.target;const n=t.split("-")[1];t.startsWith("expandContent-")&&(document.getElementById("blogContent-"+n).classList.toggle("abridged"),l.innerHTML.includes("more")?l.innerHTML="Click to see less":l.innerHTML.includes("less")&&(l.innerHTML="Click to read more"))}function fillSideColumnBlogList(){blogEntriesEl.innerHTML="",blogPostsArray.forEach(e=>{let t=moment(e.published).format("dddd, MMMM Do YYYY");blogEntriesEl.innerHTML+=`\n        <p><a href="#">${t}</a></p>\n        `})}const retrievedBlogs=JSON.parse(localStorage.getItem("blogPosts"));let blogViewEl=document.getElementById("blog-view"),blogEntriesEl=document.getElementById("blog-entries-list"),noResultsEl=document.getElementById("no-results-msg");const blogPostsArray=retrievedBlogs.blogArray;let searchEl=document.getElementById("search-input"),blogSearchResults=blogPostsArray;searchEl.addEventListener("keyup",function(e){blogSearchResults=[];let t=searchEl.value.toLowerCase();console.log("searchQuery =",t),searchEl.value.length>=3?(searchAllBlogs(t),console.log("blogSearchResults = ",blogSearchResults),loadFullPage()):(blogSearchResults=blogPostsArray,loadFullPage())}),loadFullPage(),fillSideColumnBlogList();